
// Event listener for when the cart page loads
document.addEventListener("DOMContentLoaded", function(event) {
  loadLocalCartInfo();
  loadMenuFromServer();
  loadBasicUserInfo();
  var orderSummary = document.getElementsByClassName("order-summary")[0];
  summarizeOrder(window.globalCart, orderSummary, true);

  // Creates an event listener for the increment buttons.
  $('.order-summary').on('click', '.increment-btn', function(event) {
    var itemId = this.parentNode.parentNode.parentNode.id;
    var index = findCartItem(itemId, window.globalCart["items"]);
    var quantityField = this.parentNode.getElementsByClassName("quantity-field")[0];
    var newItemQuantity = Number(quantityField.innerHTML) + 1;
    var oldItemQuantity = window.globalCart["items"][index]["quantity"];

    if (index === -1) {
      alert("Error! User's cart was not up to date with the one retrieved from the server.");
    }

    addCartItem(itemId, newItemQuantity-oldItemQuantity);
    updateCartEntryDisplay(index);
    deleteCartItemOfQuantityZero(index);
    $('#total-row').remove();
    summarizeOrderTotal(window.globalCart, $('.order-summary')[0]);
    $("#cart-btn").html("<h1>Cart (" + window.globalCart["totalItems"] + ")</h1>");
  }); // End of code for incrementing quantity to add

  // Creates an event listener for the decrement buttons.
  $('.order-summary').on('click', '.decrement-btn', function(event) {
    var itemId = this.parentNode.parentNode.parentNode.id;
    var index = findCartItem(itemId, window.globalCart["items"]);
    var quantityField = this.parentNode.getElementsByClassName("quantity-field")[0];
    var newItemQuantity = Number(quantityField.innerHTML) - 1;
    var oldItemQuantity = window.globalCart["items"][index]["quantity"];

    if (index === -1) {
      alert("Error! User's cart was not up to date with the one retrieved from the server.");
    }

    addCartItem(itemId, newItemQuantity-oldItemQuantity);
    updateCartEntryDisplay(index);
    deleteCartItemOfQuantityZero(index);
    $('#total-row').remove();
    summarizeOrderTotal(window.globalCart, $('.order-summary')[0]);
    $("#cart-btn").html("<h1>Cart (" + window.globalCart["totalItems"] + ")</h1>");
  });// End of code for decrementing quantity to add

}) // End of event listner
